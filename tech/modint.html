<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.9" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.38" />
    <style>
      html {
        background: var(--bg-color, #fff);
      }

      html[data-theme="dark"] {
        background: var(--bg-color, #1d1e1f);
      }

      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://github.com/King-sj/tech/modint.html"><meta property="og:site_name" content="blog"><meta property="og:title" content="「泛型与 OI」modint"><meta property="og:description" content="在 OI 中，有大量的题目要求对一些数字取模，这便是本文写作的背景。 背景介绍 这些题目要么是因为答案太大，不方便输出结果，例如许多计数 dp；要么是因为答案是浮点数，出题人不愿意写一个确定精度的 Special Judge，例如很多期望概率题；要么是因为这道题目直接考察了模的性质和运用，比如大量的 998244353 类的多项式题目。"><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="article:author" content="KSJ"><meta property="article:tag" content="MODInt"><meta property="article:published_time" content="2023-08-02T00:00:00.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"「泛型与 OI」modint","image":[""],"datePublished":"2023-08-02T00:00:00.000Z","dateModified":null,"author":[{"@type":"Person","name":"KSJ","url":"https://github.com/King-sj"}]}</script><title>「泛型与 OI」modint | blog</title><meta name="description" content="在 OI 中，有大量的题目要求对一些数字取模，这便是本文写作的背景。 背景介绍 这些题目要么是因为答案太大，不方便输出结果，例如许多计数 dp；要么是因为答案是浮点数，出题人不愿意写一个确定精度的 Special Judge，例如很多期望概率题；要么是因为这道题目直接考察了模的性质和运用，比如大量的 998244353 类的多项式题目。">
    <link rel="preload" href="/assets/style-Dbd0bHIw.css" as="style"><link rel="stylesheet" href="/assets/style-Dbd0bHIw.css">
    <link rel="modulepreload" href="/assets/app-Cavey8ZJ.js"><link rel="modulepreload" href="/assets/modint.html-XcEbDZ3T.js">
    <link rel="prefetch" href="/assets/index.html-DkzqyBY8.js" as="script"><link rel="prefetch" href="/assets/intro.html-BzrdrnxQ.js" as="script"><link rel="prefetch" href="/assets/index.html-CEu5vSIA.js" as="script"><link rel="prefetch" href="/assets/index.html-CktqMF4H.js" as="script"><link rel="prefetch" href="/assets/index.html-BNXyyNol.js" as="script"><link rel="prefetch" href="/assets/Qt6 Maintence tools不能安装Qt5.html--XHZmxZE.js" as="script"><link rel="prefetch" href="/assets/android studio换源.html-CG_yETOp.js" as="script"><link rel="prefetch" href="/assets/cicd.html-D5E1ZhI7.js" as="script"><link rel="prefetch" href="/assets/docker_nginx部署web项目.html-B0ovYJ8C.js" as="script"><link rel="prefetch" href="/assets/docker.html-D9vpdl2J.js" as="script"><link rel="prefetch" href="/assets/github 工作流.html-DLwXI3Vm.js" as="script"><link rel="prefetch" href="/assets/index.html-BQWq1PAS.js" as="script"><link rel="prefetch" href="/assets/steam模组开发.html-nnzQ84QO.js" as="script"><link rel="prefetch" href="/assets/style.html-BBqHILy-.js" as="script"><link rel="prefetch" href="/assets/vsocde插件开发小记.html-DF1lKOhF.js" as="script"><link rel="prefetch" href="/assets/「算术公理系统 1」自然数.html-DlIThbUc.js" as="script"><link rel="prefetch" href="/assets/使用capacitor和ionic将vue项目迁移到mobile端.html-BhDWlof4.js" as="script"><link rel="prefetch" href="/assets/协程(asyncio)到底需不需要加锁.html-nwoTW4OH.js" as="script"><link rel="prefetch" href="/assets/协程.html-Ch0u7wn3.js" as="script"><link rel="prefetch" href="/assets/程序员的PPT.html-DoyqJjWs.js" as="script"><link rel="prefetch" href="/assets/闭包实现类.html-DKEUxT1S.js" as="script"><link rel="prefetch" href="/assets/index.html-BhX6qyA7.js" as="script"><link rel="prefetch" href="/assets/typora激活.html-CLiPeEw7.js" as="script"><link rel="prefetch" href="/assets/index.html-_2lx5JuS.js" as="script"><link rel="prefetch" href="/assets/DesignPrinciples.html-gIYzjCNx.js" as="script"><link rel="prefetch" href="/assets/abstractFactory.html-CTbbcxqj.js" as="script"><link rel="prefetch" href="/assets/adapter.html-BQjXJbWS.js" as="script"><link rel="prefetch" href="/assets/bridge.html-bUK937hX.js" as="script"><link rel="prefetch" href="/assets/builder.html-kGYB0jYj.js" as="script"><link rel="prefetch" href="/assets/composite.html-KmPd9FFs.js" as="script"><link rel="prefetch" href="/assets/factory_method.html-C28sfqEb.js" as="script"><link rel="prefetch" href="/assets/index.html-jVmGn0c_.js" as="script"><link rel="prefetch" href="/assets/iterator.html-Cj-IHsU4.js" as="script"><link rel="prefetch" href="/assets/prototype.html-CLPJ3Sou.js" as="script"><link rel="prefetch" href="/assets/singleton.html-CyKJldoj.js" as="script"><link rel="prefetch" href="/assets/strategy.html-CMGqDmrR.js" as="script"><link rel="prefetch" href="/assets/template_method.html-Cx1oEKfq.js" as="script"><link rel="prefetch" href="/assets/0.html-C9Ty9N4c.js" as="script"><link rel="prefetch" href="/assets/1.html-DijuzwSJ.js" as="script"><link rel="prefetch" href="/assets/2.html-oc5ztcIj.js" as="script"><link rel="prefetch" href="/assets/3.html-C54PNj6J.js" as="script"><link rel="prefetch" href="/assets/4.html-BXS5tJnX.js" as="script"><link rel="prefetch" href="/assets/5.html-CGVcgByI.js" as="script"><link rel="prefetch" href="/assets/6.html-CmYpCrDQ.js" as="script"><link rel="prefetch" href="/assets/7.html-Crbcbxtv.js" as="script"><link rel="prefetch" href="/assets/8.html-CN4MHFlh.js" as="script"><link rel="prefetch" href="/assets/9.html-B7G9H0q-.js" as="script"><link rel="prefetch" href="/assets/404.html-BMfmknf4.js" as="script"><link rel="prefetch" href="/assets/index.html-BXIT1xL6.js" as="script"><link rel="prefetch" href="/assets/index.html-DrzD5g_7.js" as="script"><link rel="prefetch" href="/assets/index.html-CRrSibf3.js" as="script"><link rel="prefetch" href="/assets/index.html-CCfFz5FZ.js" as="script"><link rel="prefetch" href="/assets/index.html-C7F9YO0S.js" as="script"><link rel="prefetch" href="/assets/index.html-Bol78hMD.js" as="script"><link rel="prefetch" href="/assets/index.html-B3FSDLFE.js" as="script"><link rel="prefetch" href="/assets/index.html-B_f_X1xL.js" as="script"><link rel="prefetch" href="/assets/index.html-CcKvbLRC.js" as="script"><link rel="prefetch" href="/assets/index.html-BtTiUJk_.js" as="script"><link rel="prefetch" href="/assets/index.html-Dp1bvY7C.js" as="script"><link rel="prefetch" href="/assets/index.html-Dx8-z81k.js" as="script"><link rel="prefetch" href="/assets/index.html-DU9YhP6h.js" as="script"><link rel="prefetch" href="/assets/index.html-s8vln_Ub.js" as="script"><link rel="prefetch" href="/assets/index.html-Cvi6zRFs.js" as="script"><link rel="prefetch" href="/assets/index.html-BI8b4gI3.js" as="script"><link rel="prefetch" href="/assets/index.html-3thQuEwg.js" as="script"><link rel="prefetch" href="/assets/index.html-BXTj1jI2.js" as="script"><link rel="prefetch" href="/assets/index.html-BYIxxyV6.js" as="script"><link rel="prefetch" href="/assets/index.html-C_gkZLUf.js" as="script"><link rel="prefetch" href="/assets/index.html-CHjeUSfT.js" as="script"><link rel="prefetch" href="/assets/index.html-B4htW_PU.js" as="script"><link rel="prefetch" href="/assets/index.html-BpINEt6h.js" as="script"><link rel="prefetch" href="/assets/index.html-CHrDhmWq.js" as="script"><link rel="prefetch" href="/assets/index.html-BpINEt6h.js" as="script"><link rel="prefetch" href="/assets/index.html-9eEJzfck.js" as="script"><link rel="prefetch" href="/assets/index.html-Bp93Pe2j.js" as="script"><link rel="prefetch" href="/assets/index.html-3kubfDJL.js" as="script"><link rel="prefetch" href="/assets/index.html-hdY62GaX.js" as="script"><link rel="prefetch" href="/assets/index.html-Dh3QnJcE.js" as="script"><link rel="prefetch" href="/assets/index.html-CworIEpY.js" as="script"><link rel="prefetch" href="/assets/index.html-7qAE2faG.js" as="script"><link rel="prefetch" href="/assets/index.html-CcTfCQJP.js" as="script"><link rel="prefetch" href="/assets/index.html-DC0VkAmO.js" as="script"><link rel="prefetch" href="/assets/index.html-Rk8R42CR.js" as="script"><link rel="prefetch" href="/assets/index.html-B2iR3PRT.js" as="script"><link rel="prefetch" href="/assets/giscus--_FS5kYt.js" as="script"><link rel="prefetch" href="/assets/mermaid.core-rQIQs7yd.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-SzV8tJDW.js" as="script"><link rel="prefetch" href="/assets/SearchResult-DHatt-nA.js" as="script"><link rel="prefetch" href="/assets/index-BNnYFWcz.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="route-link vp-brand" href="/"><img class="vp-nav-logo" src="/logo.svg" alt><!----><span class="vp-site-name hide-in-pad">blog</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link nav-link" href="/" aria-label="主页"><span class="font-icon icon home" style=""></span>主页<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link nav-link active" href="/tech/" aria-label="技术"><!---->技术<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link nav-link" href="/essays/" aria-label="随笔"><!---->随笔<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link nav-link" href="/projects/" aria-label="项目"><!---->项目<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link nav-link" href="/tutorials/" aria-label="教程"><!---->教程<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link nav-link" href="/resources/" aria-label="资源"><!---->资源<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="友链"><span class="title"><!---->友链</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="https://bupt.online" rel="noopener noreferrer" target="_blank" aria-label="KSJ-Blog" class="nav-link"><!---->KSJ-Blog<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="dropdown-item"><a href="https://king-sj.github.io" rel="noopener noreferrer" target="_blank" aria-label="KSJ-Blog-GitHub" class="nav-link"><!---->KSJ-Blog-GitHub<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li></ul></button></div></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/King-sj/KBlog" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!--[--><button type="button" class="search-pro-button" aria-label="搜索"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="search-pro-placeholder">搜索</div><div class="search-pro-key-hints"><kbd class="search-pro-key">Ctrl</kbd><kbd class="search-pro-key">K</kbd></div></button><!--]--><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">技术</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link nav-link active vp-sidebar-link vp-sidebar-page active" href="/tech/modint.html" aria-label="「泛型与 OI」modint"><!---->「泛型与 OI」modint<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/tech/%E3%80%8C%E7%AE%97%E6%9C%AF%E5%85%AC%E7%90%86%E7%B3%BB%E7%BB%9F%201%E3%80%8D%E8%87%AA%E7%84%B6%E6%95%B0.html" aria-label="「算术公理系统 1」自然数"><!---->「算术公理系统 1」自然数<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/tech/android%20studio%E6%8D%A2%E6%BA%90.html" aria-label="android studio换源"><!---->android studio换源<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/tech/cicd.html" aria-label="CI/CD"><!---->CI/CD<!----></a></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Design ASimpile CCompiler</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Design Patterns</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/tech/docker_nginx%E9%83%A8%E7%BD%B2web%E9%A1%B9%E7%9B%AE.html" aria-label="docker + nginx + acme.sh 部署 vue/flask 项目"><!---->docker + nginx + acme.sh 部署 vue/flask 项目<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/tech/docker.html" aria-label="docker in wsl"><!---->docker in wsl<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/tech/steam%E6%A8%A1%E7%BB%84%E5%BC%80%E5%8F%91.html" aria-label="Game Plugin"><!---->Game Plugin<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/tech/github%20%E5%B7%A5%E4%BD%9C%E6%B5%81.html" aria-label="github 工作流程"><!---->github 工作流程<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/tech/Qt6%20Maintence%20tools%E4%B8%8D%E8%83%BD%E5%AE%89%E8%A3%85Qt5.html" aria-label="Qt"><!---->Qt<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/tech/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84PPT.html" aria-label="Slidev"><!---->Slidev<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/tech/vsocde%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E5%B0%8F%E8%AE%B0.html" aria-label="vscode plugin"><!---->vscode plugin<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/tech/%E4%BD%BF%E7%94%A8capacitor%E5%92%8Cionic%E5%B0%86vue%E9%A1%B9%E7%9B%AE%E8%BF%81%E7%A7%BB%E5%88%B0mobile%E7%AB%AF.html" aria-label="使用capacitor和ionic将vue项目迁移到mobile端"><!---->使用capacitor和ionic将vue项目迁移到mobile端<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/tech/%E5%8D%8F%E7%A8%8B.html" aria-label="协程"><!---->协程<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/tech/%E5%8D%8F%E7%A8%8B(asyncio)%E5%88%B0%E5%BA%95%E9%9C%80%E4%B8%8D%E9%9C%80%E8%A6%81%E5%8A%A0%E9%94%81.html" aria-label="并发异步编程之争：协程(asyncio)到底需不需要加锁？(线程/协程安全/挂起/主动切换)Python3"><!---->并发异步编程之争：协程(asyncio)到底需不需要加锁？(线程/协程安全/挂起/主动切换)Python3<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/tech/" aria-label="技术"><!---->技术<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/tech/%E9%97%AD%E5%8C%85%E5%AE%9E%E7%8E%B0%E7%B1%BB.html" aria-label="闭包实现类"><!---->闭包实现类<!----></a></li><li><a class="route-link nav-link vp-sidebar-link vp-sidebar-page" href="/tech/style.html" aria-label="风格统一"><!---->风格统一<!----></a></li></ul></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!--[--><!----><!--]--><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->「泛型与 OI」modint</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/King-sj" target="_blank" rel="noopener noreferrer">KSJ</a></span><span property="author" content="KSJ"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-08-02T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 2 分钟</span><meta property="timeRequired" content="PT2M"></span><span class="page-category-info" aria-label="分类🌈" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item category6 clickable" role="navigation">OI</span><!--]--><meta property="articleSection" content="OI"></span><span class="page-tag-info" aria-label="标签🏷" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item tag8 clickable" role="navigation">MODInt</span><!--]--><meta property="keywords" content="MODInt"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc"><!--[--><!----><!--]--><div class="vp-toc-header">此页内容<button type="button" class="print-button" title="打印"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#背景介绍">背景介绍</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#过去的做法">过去的做法</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#第一种-直接取模">第一种 直接取模</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#第二种-函数取模">第二种 函数取模</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#泛型编程">泛型编程</a></li><!----><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!--[--><!----><!--]--><div class="theme-hope-content"><h1 id="「泛型与-oi」modint" tabindex="-1"><a class="header-anchor" href="#「泛型与-oi」modint"><span>「泛型与 OI」modint</span></a></h1><p>在 OI 中，有大量的题目要求对一些数字取模，这便是本文写作的背景。</p><h2 id="背景介绍" tabindex="-1"><a class="header-anchor" href="#背景介绍"><span>背景介绍</span></a></h2><p>这些题目要么是因为答案太大，不方便输出结果，例如许多计数 dp；要么是因为答案是浮点数，出题人不愿意写一个确定精度的 Special Judge，例如很多期望概率题；要么是因为这道题目直接考察了模的性质和运用，比如大量的 998244353 类的多项式题目。</p><!-- more --><h2 id="过去的做法" tabindex="-1"><a class="header-anchor" href="#过去的做法"><span>过去的做法</span></a></h2><p>在这种要求之下，取模运算就成为了编程中不可缺少的一部分。下面以式子 <mjx-container class="MathJax" jax="SVG" style="position:relative;"><svg style="vertical-align:-0.566ex;" xmlns="http://www.w3.org/2000/svg" width="21.387ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 9452.9 1000" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtext"><path data-c="1D68A" d="M126 306Q105 306 90 321T74 359Q74 439 211 439Q268 439 276 438Q343 426 383 390T430 306Q431 301 431 190V81Q446 79 465 78T492 76T509 72T521 60T524 38Q524 11 506 3Q502 1 466 1Q426 1 406 5T379 14T355 36L345 30Q284 -6 205 -6Q135 -6 92 39T48 141Q48 182 79 212T158 256T252 278T342 285H347V290Q347 315 325 335T267 362Q258 363 224 363Q189 363 185 362H179L178 358Q178 353 178 352T176 345T174 337T170 330T165 322T158 316T150 311T139 308T126 306ZM132 140Q132 115 157 93T224 70Q269 70 302 87T344 133Q346 139 347 175V211H339Q256 209 194 190T132 140Z"></path><path data-c="1D697" d="M89 431Q94 431 105 431T122 432Q173 432 173 399Q173 394 175 394Q176 394 190 404T233 425T298 436Q343 436 371 423Q411 402 423 365T436 265Q436 257 436 239T435 211V198V76H498Q512 67 516 60T520 38Q520 9 498 1H308Q286 9 286 32V38V45Q286 65 303 73Q309 76 329 76H351V188Q351 204 351 230T352 266Q352 321 341 341T288 361Q253 361 222 341T176 274L174 264L173 170V76H236Q250 67 254 60T258 38Q258 9 236 1H27Q4 8 4 38Q4 53 8 60T27 76H89V355H58L27 356Q4 363 4 393Q4 408 8 415T27 431H89Z" transform="translate(525,0)"></path><path data-c="1D69C" d="M72 317Q72 361 108 396T229 439Q231 439 245 439T268 440Q303 439 324 435T353 427T363 423L372 432Q380 440 397 440Q430 440 430 395Q430 390 430 380T429 366V335Q429 311 422 302T387 293Q364 293 355 300T346 316T343 336T325 353Q306 364 257 364Q209 364 178 351T147 317Q147 284 231 272Q327 256 357 247Q458 210 458 129V121Q458 74 413 34T271 -6Q246 -6 224 -3T189 5T165 14T150 22T144 26Q142 23 139 18T135 11T132 6T128 1T124 -2T119 -4T113 -5T104 -6Q84 -6 78 6T71 43Q71 48 71 60T72 79Q72 132 73 141T81 157Q90 166 115 166Q135 166 142 162T157 140Q168 108 191 90T260 70Q297 70 323 76T361 91T379 110T384 129Q384 157 346 171T247 195T165 212Q119 228 96 256T72 317Z" transform="translate(1050,0)"></path></g><g data-mml-node="mo" transform="translate(1852.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mo" transform="translate(2908.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(3297.6,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mo" transform="translate(4091.8,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mi" transform="translate(5092,0)"><path data-c="1D466" d="M21 287Q21 301 36 335T84 406T158 442Q199 442 224 419T250 355Q248 336 247 334Q247 331 231 288T198 191T182 105Q182 62 196 45T238 27Q261 27 281 38T312 61T339 94Q339 95 344 114T358 173T377 247Q415 397 419 404Q432 431 462 431Q475 431 483 424T494 412T496 403Q496 390 447 193T391 -23Q363 -106 294 -155T156 -205Q111 -205 77 -183T43 -117Q43 -95 50 -80T69 -58T89 -48T106 -45Q150 -45 150 -87Q150 -107 138 -122T115 -142T102 -147L99 -148Q101 -153 118 -160T152 -167H160Q177 -167 186 -165Q219 -156 247 -127T290 -65T313 -9T321 21L315 17Q309 13 296 6T270 -6Q250 -11 231 -11Q185 -11 150 11T104 82Q103 89 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(5804.2,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path></g><g data-mml-node="mi" transform="translate(6804.4,0)"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346T162 335T155 324L153 320Q150 317 138 317Q117 317 117 325Q117 330 120 339Q133 378 163 406T229 440Q241 442 246 442Q271 442 291 425T329 392T367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434Q468 430 463 420T449 399T432 377T418 358L411 349Q368 298 275 214T160 106L148 94L163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143Q443 138 442 134Q425 72 376 31T278 -11Q252 -11 232 6T193 40T155 57Q111 57 76 -3Q70 -11 59 -11H54H41Q35 -5 35 -2Q35 13 93 84Q132 129 225 214T340 322Q352 338 347 338Z"></path></g><g data-mml-node="mo" transform="translate(7269.4,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(7880.7,0)"><path data-c="D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></g><g data-mml-node="mi" transform="translate(8880.9,0)"><path data-c="1D462" d="M21 287Q21 295 30 318T55 370T99 420T158 442Q204 442 227 417T250 358Q250 340 216 246T182 105Q182 62 196 45T238 27T291 44T328 78L339 95Q341 99 377 247Q407 367 413 387T427 416Q444 431 463 431Q480 431 488 421T496 402L420 84Q419 79 419 68Q419 43 426 35T447 26Q469 29 482 57T512 145Q514 153 532 153Q551 153 551 144Q550 139 549 130T540 98T523 55T498 17T462 -8Q454 -10 438 -10Q372 -10 347 46Q345 45 336 36T318 21T296 6T267 -6T233 -11Q189 -11 155 7Q103 38 103 113Q103 170 138 262T173 379Q173 380 173 381Q173 390 173 393T169 400T158 404H154Q131 404 112 385T82 344T65 302T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="inline"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext mathvariant="monospace">ans</mtext><mo>=</mo><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mi>y</mi><mo>+</mo><mi>z</mi><mo stretchy="false">)</mo><mo>×</mo><mi>u</mi></math></mjx-assistive-mml></mjx-container> 为例介绍几种写法。</p><h3 id="第一种-直接取模" tabindex="-1"><a class="header-anchor" href="#第一种-直接取模"><span>第一种 直接取模</span></a></h3><p>这种方法是直接取模，简单直接，清晰明了。</p><div class="language-cpp line-numbers-mode" data-ext="cpp" data-title="cpp"><pre class="language-cpp"><code><span class="token keyword">constexpr</span> <span class="token keyword">int</span> p<span class="token operator">=</span><span class="token number">998244353</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> ans<span class="token operator">=</span><span class="token number">1ll</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token operator">+</span>y<span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token operator">+</span>z<span class="token punctuation">)</span><span class="token operator">%</span>p<span class="token punctuation">)</span><span class="token operator">*</span>u<span class="token operator">%</span>p<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>但是这种方法有着严重的缺陷，一是容易忘记大括号，二是容易中间运算时搞错运算顺序、忘记取模，三是式子太长、括号太多、不易检验。</p><p>因此，不推荐运用这种方法。</p><h3 id="第二种-函数取模" tabindex="-1"><a class="header-anchor" href="#第二种-函数取模"><span>第二种 函数取模</span></a></h3><p>这种方法有效地解决了直接取模的忘记取模的漏洞。</p><div class="language-cpp line-numbers-mode" data-ext="cpp" data-title="cpp"><pre class="language-cpp"><code><span class="token keyword">constexpr</span> <span class="token keyword">int</span> p<span class="token operator">=</span><span class="token number">998244353</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> a<span class="token operator">+</span>b<span class="token operator">&gt;=</span>p<span class="token operator">?</span>a<span class="token operator">+</span>b<span class="token operator">-</span>p<span class="token operator">:</span>a<span class="token operator">+</span>b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">sub</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> a<span class="token operator">&lt;</span>b<span class="token operator">?</span>a<span class="token operator">-</span>b<span class="token operator">+</span>p<span class="token operator">:</span>a<span class="token operator">-</span>b<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">mul</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token number">1ll</span><span class="token operator">*</span>a<span class="token operator">*</span>b<span class="token operator">%</span>p<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> ans<span class="token operator">=</span><span class="token function">mul</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token function">add</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">,</span>z<span class="token punctuation">)</span><span class="token punctuation">,</span>u<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>但是，这种写法的式子依旧太长，不易检验，并且如果编译器没有任何优化（现在不存在这种情况了）的话，大量的函数调用将会耗费不少的时间。并且如果要对多个模数取模，则需要写多个函数，显得代码冗长。</p><h2 id="泛型编程" tabindex="-1"><a class="header-anchor" href="#泛型编程"><span>泛型编程</span></a></h2><p>考虑到函数取模的优点，我们不妨通过类的运算符重载来进一步优化 <code>add</code> 等函数。</p><p>同时为了解决多个模数的问题，我们考虑泛型编程，将模数直接包含在类型中。</p><div class="language-cpp line-numbers-mode" data-ext="cpp" data-title="cpp"><pre class="language-cpp"><code><span class="token keyword">template</span><span class="token operator">&lt;</span><span class="token keyword">typename</span> <span class="token class-name">T</span><span class="token punctuation">,</span><span class="token keyword">const</span> T p<span class="token operator">&gt;</span>
<span class="token keyword">class</span> <span class="token class-name">modint</span><span class="token punctuation">{</span>
	<span class="token keyword">private</span><span class="token operator">:</span>
		T v<span class="token punctuation">;</span>
	<span class="token keyword">public</span><span class="token operator">:</span>
		<span class="token function">modint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
		<span class="token function">modint</span><span class="token punctuation">(</span><span class="token keyword">const</span> T<span class="token operator">&amp;</span> x<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token function">assert</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">&lt;=</span>x<span class="token operator">&amp;&amp;</span>x<span class="token operator">&lt;</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>v<span class="token operator">=</span>x<span class="token punctuation">;</span><span class="token punctuation">}</span>
		modint <span class="token keyword">operator</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token keyword">const</span> modint<span class="token operator">&amp;</span> a<span class="token punctuation">)</span><span class="token keyword">const</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> v<span class="token operator">+</span>a<span class="token punctuation">.</span>v<span class="token operator">&gt;=</span>p<span class="token operator">?</span>v<span class="token operator">+</span>a<span class="token punctuation">.</span>v<span class="token operator">-</span>p<span class="token operator">:</span>v<span class="token operator">+</span>a<span class="token punctuation">.</span>v<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		modint <span class="token keyword">operator</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token keyword">const</span> modint<span class="token operator">&amp;</span> a<span class="token punctuation">)</span><span class="token keyword">const</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> v<span class="token operator">&lt;</span>a<span class="token punctuation">.</span>v<span class="token operator">?</span>v<span class="token operator">-</span>a<span class="token punctuation">.</span>v<span class="token operator">+</span>p<span class="token operator">:</span>v<span class="token operator">-</span>a<span class="token punctuation">.</span>v<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		modint <span class="token keyword">operator</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token keyword">const</span> modint<span class="token operator">&amp;</span> a<span class="token punctuation">)</span><span class="token keyword">const</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token number">1ll</span><span class="token operator">*</span>v<span class="token operator">*</span>a<span class="token punctuation">.</span>v<span class="token operator">%</span>p<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		T <span class="token keyword">operator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span><span class="token keyword">const</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> v<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

modint<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token number">998244353</span><span class="token operator">&gt;</span> <span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">y</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">z</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">u</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
modint<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token number">998244353</span><span class="token operator">&gt;</span> ans<span class="token operator">=</span><span class="token punctuation">(</span>x<span class="token operator">+</span>y<span class="token operator">+</span>z<span class="token punctuation">)</span><span class="token operator">*</span>u<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这样使用的时候，一方面减少了心智负担，不用操心运算时忘记取模；另一方面采取了常数更小的加减法操作，运算更快。</p><p>唯一的缺点就是类型名难写，但是模数个数少的时候可以缩写，即写成：</p><div class="language-cpp line-numbers-mode" data-ext="cpp" data-title="cpp"><pre class="language-cpp"><code><span class="token keyword">typedef</span> modint<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span><span class="token number">998244353</span><span class="token operator">&gt;</span> modInt1<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这样就解决了类型名长的缺点。</p></div><!--[--><!----><!--]--><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a href="https://github.com/King-sj/KBlog/edit/main/src/tech/modint.md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页" class="nav-link vp-meta-label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->在 GitHub 上编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="vp-meta-item git-info"><!----><!----></div></footer><nav class="vp-page-nav"><!----><a class="route-link nav-link next" href="/tech/%E3%80%8C%E7%AE%97%E6%9C%AF%E5%85%AC%E7%90%86%E7%B3%BB%E7%BB%9F%201%E3%80%8D%E8%87%AA%E7%84%B6%E6%95%B0.html" aria-label="「算术公理系统 1」自然数"><div class="hint">下一页<span class="arrow end"></span></div><div class="link">「算术公理系统 1」自然数<!----></div></a></nav><div id="vp-comment" class="giscus-wrapper input-top" style="display:block;"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" preserveAspectRatio="xMidYMid" viewBox="0 0 100 100"><circle cx="28" cy="75" r="11" fill="currentColor"><animate attributeName="fill-opacity" begin="0s" dur="1s" keyTimes="0;0.2;1" repeatCount="indefinite" values="0;1;1"></animate></circle><path fill="none" stroke="#88baf0" stroke-width="10" d="M28 47a28 28 0 0 1 28 28"><animate attributeName="stroke-opacity" begin="0.1s" dur="1s" keyTimes="0;0.2;1" repeatCount="indefinite" values="0;1;1"></animate></path><path fill="none" stroke="#88baf0" stroke-width="10" d="M28 25a50 50 0 0 1 50 50"><animate attributeName="stroke-opacity" begin="0.2s" dur="1s" keyTimes="0;0.2;1" repeatCount="indefinite" values="0;1;1"></animate></path></svg></div><!--[--><!----><!--]--><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer"><a href='https://beian.miit.gov.cn'>黔ICP备2024025117号-1</a> | 版权所有 © 2024-至今 KSJ </div><div class="vp-copyright">MPL-2.0 许可证</div></footer></div><!--]--><!--[--><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-Cavey8ZJ.js" defer></script>
  </body>
</html>
