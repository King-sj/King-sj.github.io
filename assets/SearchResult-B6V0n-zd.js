import{u as G,g as te,h as se,i as U,j as ae,P as le,t as re,k as oe,l as F,m as f,n as ie,w as V,p as s,q as ue,R as T,s as ne,v as ce,x as pe,C as ve,y as de,z as he,A as ye,B as me,D as ge,E as Ee,F as Ae,G as _,H as $,I as Be,J as w,K as Ce}from"./app-DQZNSqWz.js";const ke=["/","/archive1.html","/archive2.html","/intro.html","/sticky.html","/sticky2.html","/classBook/","/encrypt/","/encrypt/encrypt.html","/posts/","/classBook/OS/","/posts/Android/","/posts/Android/warning.html","/posts/CI_CD/","/posts/Java/","/posts/OI/modint.html","/posts/OS/","/posts/PPT/","/posts/Qt/","/posts/Vue/%E5%A4%9A%E4%B8%AArouter-view.html","/posts/compiler/","/posts/database/","/posts/gamePlugin/","/posts/github/CHANGELOG.html","/posts/github/","/posts/interpreter/","/posts/math/arithmetic1.html","/posts/vscodePlugin/","/posts/%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/docker-nginx.html","/posts/%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/docker.html","/posts/%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/ssl.html","/posts/%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/style.html","/posts/%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/%E9%97%AD%E5%8C%85%E5%AE%9E%E7%8E%B0%E7%B1%BB.html","/classBook/OS/introductoryTheory/","/posts/Android/Capacitor/bug.html","/posts/Android/Capacitor/","/posts/Android/Flutter/","/posts/Android/GRADLE/","/posts/Android/Ionic/","/posts/Android/Ionic/tip.html","/posts/CI_CD/githubActions/","/posts/compiler/designASimpileCCompiler/0.html","/posts/compiler/designASimpileCCompiler/","/posts/database/PostgreSQL/","/404.html","/posts/OI/","/posts/Vue/","/posts/math/","/posts/%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/","/category/","/category/history/","/category/categoryc/","/category/index/","/category/%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/","/category/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/","/category/android/","/category/oi/","/category/%E6%95%B0%E5%AD%A6/","/category/%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/","/category/docker/","/category/%E9%A3%8E%E6%A0%BC/","/category/build-tools/","/category/cicd/","/tag/","/tag/wwi/","/tag/wwii/","/tag/tag-e/","/tag/%E5%8A%A0%E5%AF%86/","/tag/android/","/tag/tip/","/tag/modint/","/tag/%E5%89%8D%E7%AB%AF/","/tag/vue/","/tag/%E5%85%AC%E7%90%86%E7%B3%BB%E7%BB%9F/","/tag/docker/","/tag/%E9%A3%8E%E6%A0%BC/","/tag/cicd/","/article/","/star/","/timeline/"],He="SEARCH_PRO_QUERY_HISTORY",g=G(He,[]),fe=()=>{const{queryHistoryCount:a}=w,l=a>0;return{enabled:l,queryHistory:g,addQueryHistory:r=>{l&&(g.value=Array.from(new Set([r,...g.value.slice(0,a-1)])))},removeQueryHistory:r=>{g.value=[...g.value.slice(0,r),...g.value.slice(r+1)]}}},L=a=>ke[a.id]+("anchor"in a?`#${a.anchor}`:""),we="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:j}=w,E=G(we,[]),Re=()=>{const a=j>0;return{enabled:a,resultHistory:E,addResultHistory:l=>{if(a){const r={link:L(l),display:l.display};"header"in l&&(r.header=l.header),E.value=[r,...E.value.slice(0,j-1)]}},removeResultHistory:l=>{E.value=[...E.value.slice(0,l),...E.value.slice(l+1)]}}},De=a=>{const l=ve(),r=U(),R=de(),i=F(0),C=f(()=>i.value>0),h=he([]);return ye(()=>{const{search:y,terminate:D}=me(),A=Be(c=>{const B=c.join(" "),{searchFilter:Q=d=>d,splitWord:S,suggestionsFilter:O,...m}=l.value;B?(i.value+=1,y(c.join(" "),r.value,m).then(d=>Q(d,B,r.value,R.value)).then(d=>{i.value-=1,h.value=d}).catch(d=>{console.warn(d),i.value-=1,i.value||(h.value=[])})):h.value=[]},w.searchDelay-w.suggestDelay);V([a,r],([c])=>A(c),{immediate:!0}),ge(()=>{D()})}),{isSearching:C,results:h}};var Se=te({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(a,{emit:l}){const r=se(),R=U(),i=ae(le),{enabled:C,addQueryHistory:h,queryHistory:y,removeQueryHistory:D}=fe(),{enabled:A,resultHistory:c,addResultHistory:B,removeResultHistory:Q}=Re(),S=C||A,O=re(a,"queries"),{results:m,isSearching:d}=De(O),o=oe({isQuery:!0,index:0}),p=F(0),v=F(0),P=f(()=>S&&(y.value.length>0||c.value.length>0)),x=f(()=>m.value.length>0),b=f(()=>m.value[p.value]||null),Y=()=>{const{isQuery:e,index:t}=o;t===0?(o.isQuery=!e,o.index=e?c.value.length-1:y.value.length-1):o.index=t-1},J=()=>{const{isQuery:e,index:t}=o;t===(e?y.value.length-1:c.value.length-1)?(o.isQuery=!e,o.index=0):o.index=t+1},M=()=>{p.value=p.value>0?p.value-1:m.value.length-1,v.value=b.value.contents.length-1},z=()=>{p.value=p.value<m.value.length-1?p.value+1:0,v.value=0},K=()=>{v.value<b.value.contents.length-1?v.value+=1:z()},N=()=>{v.value>0?v.value-=1:M()},q=e=>e.map(t=>Ce(t)?t:s(t[0],t[1])),W=e=>{if(e.type==="customField"){const t=Ee[e.index]||"$content",[u,H=""]=Ae(t)?t[R.value].split("$content"):t.split("$content");return e.display.map(n=>s("div",q([u,...n,H])))}return e.display.map(t=>s("div",q(t)))},k=()=>{p.value=0,v.value=0,l("updateQuery",""),l("close")},X=()=>C?s("ul",{class:"search-pro-result-list"},s("li",{class:"search-pro-result-list-item"},[s("div",{class:"search-pro-result-title"},i.value.queryHistory),y.value.map((e,t)=>s("div",{class:["search-pro-result-item",{active:o.isQuery&&o.index===t}],onClick:()=>{l("updateQuery",e)}},[s(_,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},e),s("button",{class:"search-pro-remove-icon",innerHTML:$,onClick:u=>{u.preventDefault(),u.stopPropagation(),D(t)}})]))])):null,Z=()=>A?s("ul",{class:"search-pro-result-list"},s("li",{class:"search-pro-result-list-item"},[s("div",{class:"search-pro-result-title"},i.value.resultHistory),c.value.map((e,t)=>s(T,{to:e.link,class:["search-pro-result-item",{active:!o.isQuery&&o.index===t}],onClick:()=>{k()}},()=>[s(_,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},[e.header?s("div",{class:"content-header"},e.header):null,s("div",e.display.map(u=>q(u)).flat())]),s("button",{class:"search-pro-remove-icon",innerHTML:$,onClick:u=>{u.preventDefault(),u.stopPropagation(),Q(t)}})]))])):null;return ie("keydown",e=>{if(a.isFocusing){if(x.value){if(e.key==="ArrowUp")N();else if(e.key==="ArrowDown")K();else if(e.key==="Enter"){const t=b.value.contents[v.value];h(a.queries.join(" ")),B(t),r.push(L(t)),k()}}else if(A){if(e.key==="ArrowUp")Y();else if(e.key==="ArrowDown")J();else if(e.key==="Enter"){const{index:t}=o;o.isQuery?(l("updateQuery",y.value[t]),e.preventDefault()):(r.push(c.value[t].link),k())}}}}),V([p,v],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>s("div",{class:["search-pro-result-wrapper",{empty:a.queries.length?!x.value:!P.value}],id:"search-pro-results"},a.queries.length?d.value?s(ue,{hint:i.value.searching}):x.value?s("ul",{class:"search-pro-result-list"},m.value.map(({title:e,contents:t},u)=>{const H=p.value===u;return s("li",{class:["search-pro-result-list-item",{active:H}]},[s("div",{class:"search-pro-result-title"},e||i.value.defaultTitle),t.map((n,ee)=>{const I=H&&v.value===ee;return s(T,{to:L(n),class:["search-pro-result-item",{active:I,"aria-selected":I}],onClick:()=>{h(a.queries.join(" ")),B(n),k()}},()=>[n.type==="text"?null:s(n.type==="title"?ne:n.type==="heading"?ce:pe,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},[n.type==="text"&&n.header?s("div",{class:"content-header"},n.header):null,s("div",W(n))])])})])})):i.value.emptyResult:S?P.value?[X(),Z()]:i.value.emptyHistory:i.value.emptyResult)}});export{Se as default};
